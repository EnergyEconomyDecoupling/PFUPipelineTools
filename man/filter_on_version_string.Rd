% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/utilities.R
\name{filter_on_version_string}
\alias{filter_on_version_string}
\title{Filter a database table based on a version string.}
\usage{
filter_on_version_string(
  tbl,
  version_string,
  db_table_name,
  collect = FALSE,
  conn,
  schema = schema_from_conn(conn = conn),
  fk_parent_tables = get_all_fk_tables(conn = conn, schema = schema),
  valid_from_version_colname = PFUPipelineTools::version_cols$valid_from_version,
  valid_to_version_colname = PFUPipelineTools::version_cols$valid_to_version
)
}
\arguments{
\item{tbl}{The \code{tbl} object that should be filtered.}

\item{version_string}{A string of length 1 that indicates the desired version.}

\item{db_table_name}{The name of the table to be filtered.}

\item{collect}{A boolean that tells whether to collect \code{tbl} from \code{conn}
before returning.
Default is \code{FALSE}.}

\item{conn}{The database connection.}

\item{schema}{The database schema (a \code{dm} object).
Default calls \code{schema_from_conn()}, but
you can supply a pre-computed schema for speed.
Needed only when \code{decode_fks = TRUE} (the default).
If foreign keys are not being decoded,
setting \code{NULL} may improve speed.}

\item{fk_parent_tables}{Foreign key parent tables to assist decoding
foreign keys.
Default calls \code{get_all_fk_tables()}.}

\item{valid_from_version_colname}{The name of the ValidFromVersion column.
Default is
\code{PFUPipelineTools::version_cols$valid_from_version}.}

\item{valid_to_version_colname}{The name of the ValidToVersion column.
Default is
\code{PFUPipelineTools::version_cols$valid_to_version}.}
}
\value{
A filtered version of \code{tbl}.
}
\description{
Filtering a database table based on the version you wish to download
is a common task.
In the CL-PFU database, we store data in a compressed format where
identical data points are not duplicated.
Rather, they are stored in a single row with the \code{ValidFromVersion}
and \code{ValidToVersion} columns incremented appropriately.
}
\details{
The desired version is supplied in the \code{version_string} argument.

If both \code{tbl} and \code{db_table_name} are provided, \code{db_table_name} is
ignored.
}
